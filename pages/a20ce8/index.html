<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostgreSQL 全文搜索 | notes</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/notes/img/favicon.ico">
    <meta name="description" content="我的笔记">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#41b91c">
    
    <link rel="preload" href="/notes/assets/css/0.styles.ce5369c7.css" as="style"><link rel="preload" href="/notes/assets/js/app.c9716de5.js" as="script"><link rel="preload" href="/notes/assets/js/2.73d4029d.js" as="script"><link rel="preload" href="/notes/assets/js/15.bff124da.js" as="script"><link rel="prefetch" href="/notes/assets/js/10.54f7a4e8.js"><link rel="prefetch" href="/notes/assets/js/11.78232aae.js"><link rel="prefetch" href="/notes/assets/js/12.a2155ce1.js"><link rel="prefetch" href="/notes/assets/js/13.ee61688a.js"><link rel="prefetch" href="/notes/assets/js/14.a9cfef3e.js"><link rel="prefetch" href="/notes/assets/js/16.5784eb36.js"><link rel="prefetch" href="/notes/assets/js/17.bb6eb542.js"><link rel="prefetch" href="/notes/assets/js/18.52597147.js"><link rel="prefetch" href="/notes/assets/js/19.59272e8d.js"><link rel="prefetch" href="/notes/assets/js/20.c1f563d3.js"><link rel="prefetch" href="/notes/assets/js/21.5f07712b.js"><link rel="prefetch" href="/notes/assets/js/22.fb557605.js"><link rel="prefetch" href="/notes/assets/js/23.e8f00f46.js"><link rel="prefetch" href="/notes/assets/js/24.f8c0cd3d.js"><link rel="prefetch" href="/notes/assets/js/25.041fe157.js"><link rel="prefetch" href="/notes/assets/js/26.ac93fa8d.js"><link rel="prefetch" href="/notes/assets/js/27.5dbd423a.js"><link rel="prefetch" href="/notes/assets/js/28.1d85a6bb.js"><link rel="prefetch" href="/notes/assets/js/29.72a26684.js"><link rel="prefetch" href="/notes/assets/js/3.dd3ef83d.js"><link rel="prefetch" href="/notes/assets/js/30.6d75ac17.js"><link rel="prefetch" href="/notes/assets/js/31.2fec314d.js"><link rel="prefetch" href="/notes/assets/js/32.efb5ce16.js"><link rel="prefetch" href="/notes/assets/js/33.f676063a.js"><link rel="prefetch" href="/notes/assets/js/4.a6d97bd6.js"><link rel="prefetch" href="/notes/assets/js/5.6f31d70c.js"><link rel="prefetch" href="/notes/assets/js/6.2dcc2c07.js"><link rel="prefetch" href="/notes/assets/js/7.3a348068.js"><link rel="prefetch" href="/notes/assets/js/8.8df528cd.js"><link rel="prefetch" href="/notes/assets/js/9.3d1d3402.js">
    <link rel="stylesheet" href="/notes/assets/css/0.styles.ce5369c7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes/" class="home-link router-link-active"><img src="/notes/img/logo.png" alt="notes" class="logo"> <span class="site-name can-hide">notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notes/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><a href="/notes/pages/a2f161/" class="link-title">指南</a> <span class="title" style="display:none;">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/52d5c3/" class="nav-link">主题初衷与诞生</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/a2f161/" class="nav-link">介绍</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/793dcb/" class="nav-link">快速上手</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/2f674a/" class="nav-link">目录结构</a></li><li class="dropdown-item"><h4>相关文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/pages/8dfab5/" class="nav-link">使目录栏支持h2~h6标题</a></li><li class="dropdown-subitem"><a href="/notes/pages/dd027d/" class="nav-link">如何让你的笔记更有表现力</a></li><li class="dropdown-subitem"><a href="/notes/pages/2b8e22/" class="nav-link">批量操作front matter工具</a></li><li class="dropdown-subitem"><a href="/notes/pages/0fc1d2/" class="nav-link">部署</a></li><li class="dropdown-subitem"><a href="/notes/pages/9ae0bd/" class="nav-link">关于写文章和H1标题</a></li><li class="dropdown-subitem"><a href="/notes/pages/26997d/" class="nav-link">关于博客搭建与管理</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识积累" class="dropdown-title"><a href="/notes/pages/a20ce8/" aria-current="page" class="link-title router-link-exact-active router-link-active">知识积累</a> <span class="title" style="display:none;">知识积累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/a20ce8/" aria-current="page" class="nav-link router-link-exact-active router-link-active">PostgreSQL 全文搜索</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/f14bdb/" class="nav-link">依赖注入</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/3216b0/" class="nav-link">开发常见问题</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/54651a/" class="nav-link">逻辑删除</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/1cc523/" class="nav-link">TCP 粘包和拆包</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/f51918/" class="nav-link">netty 粘包和拆包</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/ce175c/" class="nav-link">在k8s集群中搭建一个harbor私有仓库</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/d0d7eb/" class="nav-link">优雅停机</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/088c16/" class="nav-link">helm 命令学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><a href="/notes/pages/db78e2/" class="link-title">python</a> <span class="title" style="display:none;">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/db78e2/" class="nav-link">yield 关键字</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/33d574/" class="nav-link">不定参数</a></li></ul></div></div><div class="nav-item"><a href="/notes/pages/5d571c/" class="nav-link">TODO</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/notes/pages/9cc27d/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/9cc27d/" class="nav-link">REST API</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/197691/" class="nav-link">使用 IntelliJ IDEA 反编译 jar</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/c5a54d/" class="nav-link">Spring Boot 删除前后空白字符</a></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/pages/78465a/" class="nav-link">装饰器模式</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/notes/pages/c2ed40/" class="nav-link">Docker</a></div><div class="nav-item"><a href="https://huayuanzzb.github.io/awesome" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Tool Box
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/huayuanzzb/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/notes/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><a href="/notes/pages/a2f161/" class="link-title">指南</a> <span class="title" style="display:none;">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/52d5c3/" class="nav-link">主题初衷与诞生</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/a2f161/" class="nav-link">介绍</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/793dcb/" class="nav-link">快速上手</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/2f674a/" class="nav-link">目录结构</a></li><li class="dropdown-item"><h4>相关文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/pages/8dfab5/" class="nav-link">使目录栏支持h2~h6标题</a></li><li class="dropdown-subitem"><a href="/notes/pages/dd027d/" class="nav-link">如何让你的笔记更有表现力</a></li><li class="dropdown-subitem"><a href="/notes/pages/2b8e22/" class="nav-link">批量操作front matter工具</a></li><li class="dropdown-subitem"><a href="/notes/pages/0fc1d2/" class="nav-link">部署</a></li><li class="dropdown-subitem"><a href="/notes/pages/9ae0bd/" class="nav-link">关于写文章和H1标题</a></li><li class="dropdown-subitem"><a href="/notes/pages/26997d/" class="nav-link">关于博客搭建与管理</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识积累" class="dropdown-title"><a href="/notes/pages/a20ce8/" aria-current="page" class="link-title router-link-exact-active router-link-active">知识积累</a> <span class="title" style="display:none;">知识积累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/a20ce8/" aria-current="page" class="nav-link router-link-exact-active router-link-active">PostgreSQL 全文搜索</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/f14bdb/" class="nav-link">依赖注入</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/3216b0/" class="nav-link">开发常见问题</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/54651a/" class="nav-link">逻辑删除</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/1cc523/" class="nav-link">TCP 粘包和拆包</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/f51918/" class="nav-link">netty 粘包和拆包</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/ce175c/" class="nav-link">在k8s集群中搭建一个harbor私有仓库</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/d0d7eb/" class="nav-link">优雅停机</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/088c16/" class="nav-link">helm 命令学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><a href="/notes/pages/db78e2/" class="link-title">python</a> <span class="title" style="display:none;">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/db78e2/" class="nav-link">yield 关键字</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/33d574/" class="nav-link">不定参数</a></li></ul></div></div><div class="nav-item"><a href="/notes/pages/5d571c/" class="nav-link">TODO</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/notes/pages/9cc27d/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/pages/9cc27d/" class="nav-link">REST API</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/197691/" class="nav-link">使用 IntelliJ IDEA 反编译 jar</a></li><li class="dropdown-item"><!----> <a href="/notes/pages/c5a54d/" class="nav-link">Spring Boot 删除前后空白字符</a></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/pages/78465a/" class="nav-link">装饰器模式</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/notes/pages/c2ed40/" class="nav-link">Docker</a></div><div class="nav-item"><a href="https://huayuanzzb.github.io/awesome" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Tool Box
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/huayuanzzb/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>知识积累</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/pages/a20ce8/" aria-current="page" class="active sidebar-link">PostgreSQL 全文搜索</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/notes/pages/a20ce8/#安装postgresql" class="sidebar-link">安装postgresql</a></li><li class="sidebar-sub-header level2"><a href="/notes/pages/a20ce8/#如何使用" class="sidebar-link">如何使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/notes/pages/a20ce8/#准备数据" class="sidebar-link">准备数据</a></li></ul></li></ul></li><li><a href="/notes/pages/f14bdb/" class="sidebar-link">@AutoWired VS @Resource VS @Inject</a></li><li><a href="/notes/pages/3216b0/" class="sidebar-link">开发常见问题</a></li><li><a href="/notes/pages/54651a/" class="sidebar-link">逻辑删除</a></li><li><a href="/notes/pages/1cc523/" class="sidebar-link">TCP 粘包和拆包</a></li><li><a href="/notes/pages/f51918/" class="sidebar-link">netty 粘包和拆包</a></li><li><a href="/notes/pages/ce175c/" class="sidebar-link">在k8s集群中搭建一个harbor私有仓库</a></li><li><a href="/notes/pages/d0d7eb/" class="sidebar-link">优雅停机</a></li><li><a href="/notes/pages/088c16/" class="sidebar-link">helm 命令学习</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">PostgreSQL 全文搜索<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="安装postgresql"><a href="#安装postgresql" class="header-anchor">#</a> 安装postgresql</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="token function">sudo</span> yum update
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> postgresql15-server
<span class="token comment"># 初始化 postgresql</span>
<span class="token function">sudo</span> /usr/pgsql-15/bin/postgresql-15-setup initdb
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> postgresql-15
<span class="token function">sudo</span> systemctl start postgresql-15

<span class="token comment"># 检查服务</span>
<span class="token function">sudo</span> systemctl status postgresql-15
</code></pre></div><table><thead><tr><th>术语</th> <th>解释</th></tr></thead> <tbody><tr><td><code>tsvector</code></td> <td>待检索的文档</td></tr> <tr><td><code>tsquery</code></td> <td>用于检索的查询，包含了一系列的搜索词(search term)和操作符</td></tr></tbody></table> <h2 id="如何使用"><a href="#如何使用" class="header-anchor">#</a> 如何使用</h2> <h3 id="准备数据"><a href="#准备数据" class="header-anchor">#</a> 准备数据</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 建表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> t_docs <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    title <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_docs <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Learing PG Full Text Search'</span><span class="token punctuation">,</span> <span class="token string">'PG support Full Text search. Full Text Searching (or just text search) provides the capability to identify natural-language documents that satisfy a query, and optionally to sort them by relevance to the query. The most common type of search is to find all documents containing given query terms and return them in order of their similarity to the query. Notions of query and similarity are very flexible and depend on the specific application. The simplest search considers query as a set of words and similarity as the frequency of query words in the document.'</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_docs <span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Learing PG Index'</span><span class="token punctuation">,</span> <span class="token string">'Although indexes in PostgreSQL do not need maintenance or tuning, it is still important to check which indexes are actually used by the real-life query workload. Examining index usage for an individual query is done with the EXPLAIN command; its application for this purpose is illustrated in Section 14.1. It is also possible to gather overall statistics about index usage in a running server, as described in Section 28.2.'</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_docs <span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'The SQL Language'</span><span class="token punctuation">,</span> <span class="token string">'This part describes the use of the SQL language in PostgreSQL. We start with describing the general syntax of SQL, then explain how to create the structures to hold data, how to populate the database, and how to query it. The middle part lists the available data types and functions for use in SQL commands. The rest treats several aspects that are important for tuning a database for optimal performance.'</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_docs <span class="token keyword">select</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'What Is PostgreSQL'</span><span class="token punctuation">,</span> <span class="token string">'PostgreSQL is an object-relational database management system (ORDBMS) based on POSTGRES, Version 4.2, developed at the University of California at Berkeley Computer Science Department. POSTGRES pioneered many concepts that only became available in some commercial database systems much later.'</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_docs <span class="token keyword">select</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'A Brief History of PostgreSQL'</span><span class="token punctuation">,</span> <span class="token string">'The object-relational database management system now known as PostgreSQL is derived from the POSTGRES package written at the University of California at Berkeley. With over two decades of development behind it, PostgreSQL is now the most advanced open-source database available anywhere.'</span><span class="token punctuation">;</span>
</code></pre></div><p>全文搜索可以不依赖索引，如：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 关键字 `open-source` </span>
fence<span class="token operator">=</span><span class="token comment"># select id,title from t_docs where to_tsvector(content) @@ to_tsquery('open-source');</span>
 id <span class="token operator">|</span>             title
<span class="token comment">----+-------------------------------</span>
  <span class="token number">5</span> <span class="token operator">|</span> A Brief History <span class="token keyword">of</span> PostgreSQL
<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">row</span><span class="token punctuation">)</span>

<span class="token comment">-- 关键字 `postgres`</span>
fence<span class="token operator">=</span><span class="token comment"># select id,title from t_docs where to_tsvector(content) @@ to_tsquery('postgres');</span>
 id <span class="token operator">|</span>             title
<span class="token comment">----+-------------------------------</span>
  <span class="token number">4</span> <span class="token operator">|</span> What <span class="token operator">Is</span> PostgreSQL
  <span class="token number">5</span> <span class="token operator">|</span> A Brief History <span class="token keyword">of</span> PostgreSQL
<span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>

<span class="token comment">-- 关键字 `postgresql`</span>
fence<span class="token operator">=</span><span class="token comment"># select id,title from t_docs where to_tsvector(content) @@ to_tsquery('postgresql');</span>
 id <span class="token operator">|</span>             title
<span class="token comment">----+-------------------------------</span>
  <span class="token number">2</span> <span class="token operator">|</span> Learing PG <span class="token keyword">Index</span>
  <span class="token number">3</span> <span class="token operator">|</span> The <span class="token keyword">SQL</span> <span class="token keyword">Language</span>
  <span class="token number">4</span> <span class="token operator">|</span> What <span class="token operator">Is</span> PostgreSQL
  <span class="token number">5</span> <span class="token operator">|</span> A Brief History <span class="token keyword">of</span> PostgreSQL
<span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>

<span class="token comment">-- 两个关键字，从多列中检索</span>
<span class="token comment">-- 下例中如果不从title中检索，则 id 为 2 的记录不会返回</span>
fence<span class="token operator">=</span><span class="token comment"># select id,title from t_docs where to_tsvector(content || ' ' || title) @@ to_tsquery('postgres | pg');</span>
 id <span class="token operator">|</span>             title
<span class="token comment">----+-------------------------------</span>
  <span class="token number">1</span> <span class="token operator">|</span> Learing PG <span class="token keyword">Full</span> <span class="token keyword">Text</span> Search
  <span class="token number">2</span> <span class="token operator">|</span> Learing PG <span class="token keyword">Index</span>
  <span class="token number">4</span> <span class="token operator">|</span> What <span class="token operator">Is</span> PostgreSQL
  <span class="token number">5</span> <span class="token operator">|</span> A Brief History <span class="token keyword">of</span> PostgreSQL
<span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>
</code></pre></div><p>由此可知，在postgresql的默认配置下：</p> <ul><li>全文检索时关键字的大小写不影响搜索结果</li> <li>在默认词典中，<code>postgres</code> 和 <code>postgresql</code> 不是近义词，也没有派生关系</li></ul> <p>使用索引可以加速查询，全文搜索支持两种索引：</p> <ul><li>GIN</li> <li>GIST</li></ul> <p>创建 <code>GIN</code> 索引</p> <blockquote><p>索引列必须指定config name(即下例中的 <code>english</code>)，如果不指定，则会使用 <a href="https://www.postgresql.org/docs/current/runtime-config-client.html#GUC-DEFAULT-TEXT-SEARCH-CONFIG" target="_blank" rel="noopener noreferrer">default_text_search_config<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 构建索引，若后续该配置被修改，则之前已经建立的索引将无法使用。</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 复制 10000 行数据</span>
fence<span class="token operator">=</span><span class="token comment"># insert into t_docs select t*5+d.id as id, d.title, d.content from generate_series(1, 2000) as t, t_docs d;</span>
<span class="token keyword">INSERT</span> <span class="token number">0</span> <span class="token number">10000</span>
<span class="token comment">-- 创建索引</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> i_docs__content <span class="token keyword">on</span> t_docs <span class="token keyword">using</span> GIN <span class="token punctuation">(</span>to_tsvector<span class="token punctuation">(</span><span class="token string">'english'</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 检查，已经可以击中索引</span>
fence<span class="token operator">=</span><span class="token comment"># explain select id,title from t_docs where to_tsvector('english', content) @@ to_tsquery('postgres');</span>
                                                QUERY <span class="token keyword">PLAN</span>
<span class="token comment">----------------------------------------------------------------------------------------------------------</span>
 Bitmap Heap Scan <span class="token keyword">on</span> t_docs  <span class="token punctuation">(</span>cost<span class="token operator">=</span><span class="token number">12.64</span><span class="token punctuation">.</span><span class="token number">.188</span><span class="token number">.55</span> <span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">50</span> width<span class="token operator">=</span><span class="token number">520</span><span class="token punctuation">)</span>
   Recheck Cond: <span class="token punctuation">(</span>to_tsvector<span class="token punctuation">(</span><span class="token string">'english'</span>::regconfig<span class="token punctuation">,</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span>::<span class="token keyword">text</span><span class="token punctuation">)</span> @@ to_tsquery<span class="token punctuation">(</span><span class="token string">'postgres'</span>::<span class="token keyword">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token operator">-</span><span class="token operator">&gt;</span>  Bitmap <span class="token keyword">Index</span> Scan <span class="token keyword">on</span> i_docs__content  <span class="token punctuation">(</span>cost<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">.</span><span class="token number">.12</span><span class="token number">.63</span> <span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">50</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
         <span class="token keyword">Index</span> Cond: <span class="token punctuation">(</span>to_tsvector<span class="token punctuation">(</span><span class="token string">'english'</span>::regconfig<span class="token punctuation">,</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span>::<span class="token keyword">text</span><span class="token punctuation">)</span> @@ to_tsquery<span class="token punctuation">(</span><span class="token string">'postgres'</span>::<span class="token keyword">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 试验可见，创建索引之后，速度明显提升, 从 723 毫秒提升到 1 毫秒</span>
fence<span class="token operator">=</span><span class="token comment"># \timing</span>
Timing <span class="token operator">is</span> <span class="token keyword">on</span><span class="token punctuation">.</span>
fence<span class="token operator">=</span><span class="token comment"># select count(1) from t_docs where to_tsvector('english', content) @@ to_tsquery('postgres');</span>
 count
<span class="token comment">-------</span>
  <span class="token number">4002</span>
<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">row</span><span class="token punctuation">)</span>

<span class="token keyword">Time</span>: <span class="token number">723.538</span> ms
fence<span class="token operator">=</span><span class="token comment"># create index i_docs__content on t_docs using GIN (to_tsvector('english', content));</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span>
<span class="token keyword">Time</span>: <span class="token number">911.129</span> ms
fence<span class="token operator">=</span><span class="token comment"># select count(1) from t_docs where to_tsvector('english', content) @@ to_tsquery('postgres');</span>
 count
<span class="token comment">-------</span>
  <span class="token number">4002</span>
<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">row</span><span class="token punctuation">)</span>

<span class="token keyword">Time</span>: <span class="token number">1.329</span> ms
</code></pre></div><p>索引可以建立在多个列上</p> <div class="language-sql extra-class"><pre class="language-sql"><code>fence<span class="token operator">=</span><span class="token comment"># create index i_docs__title_content on t_docs using GIN (to_tsvector('english', title || ' ' || content));</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span>
</code></pre></div><p>我们还可以将 <code>to_tsvector</code> 的输出单独保存一列，保持其可以随着源数据保持更新。在其之上创建索引，以用于检索。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 新增索引列</span>
fence<span class="token operator">=</span><span class="token comment"># alter table t_docs add column search_title_content_index_col tsvector generated always as (to_tsvector('english', coalesce(title, '') || ' ' || coalesce(content, ''))) stored;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span>
<span class="token comment">-- 检查索引列数据</span>
fence<span class="token operator">=</span><span class="token comment"># select search_title_content_index_col from t_docs limit 1;</span>
                                                                                                                                                                                                                                          sear
ch_title_content_index_col

<span class="token comment">----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="token comment">----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="token comment">----------------------</span>
 <span class="token string">'applic'</span>:<span class="token number">80</span> <span class="token string">'capabl'</span>:<span class="token number">20</span> <span class="token string">'common'</span>:<span class="token number">43</span> <span class="token string">'consid'</span>:<span class="token number">84</span> <span class="token string">'contain'</span>:<span class="token number">52</span> <span class="token string">'depend'</span>:<span class="token number">76</span> <span class="token string">'document'</span>:<span class="token number">26</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">101</span> <span class="token string">'find'</span>:<span class="token number">49</span> <span class="token string">'flexibl'</span>:<span class="token number">74</span> <span class="token string">'frequenc'</span>:<span class="token number">95</span> <span class="token string">'full'</span>:<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">11</span> <span class="token string">'given'</span>:<span class="token number">53</span> <span class="token string">'identifi'</span>:<span class="token number">22</span> <span class="token string">'languag'</span>:<span class="token number">25</span> <span class="token string">'lear'</span>:<span class="token number">1</span> <span class="token string">'natur'</span>:<span class="token number">24</span> <span class="token string">'natural-languag'</span>:<span class="token number">23</span> <span class="token string">'notion'</span>:<span class="token number">67</span> <span class="token string">'
option'</span>:<span class="token number">32</span> <span class="token string">'order'</span>:<span class="token number">60</span> <span class="token string">'pg'</span>:<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token string">'provid'</span>:<span class="token number">18</span> <span class="token string">'queri'</span>:<span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">97</span> <span class="token string">'relev'</span>:<span class="token number">37</span> <span class="token string">'return'</span>:<span class="token number">57</span> <span class="token string">'satisfi'</span>:<span class="token number">28</span> <span class="token string">'search'</span>:<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">83</span> <span class="token string">'set'</span>:<span class="token number">88</span> <span class="token string">'similar'</span>:<span class="token number">63</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">92</span> <span class="token string">'simplest'</span>:<span class="token number">82</span> <span class="token string">'sort'</span>:<span class="token number">34</span> <span class="token string">'specif'</span>:<span class="token number">79</span> <span class="token string">'support'</span>:<span class="token number">7</span> <span class="token string">'term'</span>:<span class="token number">55</span> <span class="token string">'text'</span>:<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">16</span> <span class="token string">'
type'</span>:<span class="token number">44</span> <span class="token string">'word'</span>:<span class="token number">90</span><span class="token punctuation">,</span><span class="token number">98</span>
<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">row</span><span class="token punctuation">)</span>
<span class="token comment">-- 在索引列上创建索引</span>
fence<span class="token operator">=</span><span class="token comment"># create index i_docs__title_content_index_col on t_docs using GIN(search_title_content_index_col);</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span>
<span class="token comment">-- 检验是否击中索引</span>
fence<span class="token operator">=</span><span class="token comment"># explain select count(1) from t_docs where search_title_content_index_col @@  to_tsquery('postgres');</span>
                                              QUERY <span class="token keyword">PLAN</span>
<span class="token comment">------------------------------------------------------------------------------------------------------</span>
 Aggregate  <span class="token punctuation">(</span>cost<span class="token operator">=</span><span class="token number">195.90</span><span class="token punctuation">.</span><span class="token number">.195</span><span class="token number">.91</span> <span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">1</span> width<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
   <span class="token operator">-</span><span class="token operator">&gt;</span>  Bitmap Heap Scan <span class="token keyword">on</span> t_docs  <span class="token punctuation">(</span>cost<span class="token operator">=</span><span class="token number">12.64</span><span class="token punctuation">.</span><span class="token number">.195</span><span class="token number">.77</span> <span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">50</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
         Recheck Cond: <span class="token punctuation">(</span>search_title_content_index_col @@ to_tsquery<span class="token punctuation">(</span><span class="token string">'postgres'</span>::<span class="token keyword">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token operator">-</span><span class="token operator">&gt;</span>  Bitmap <span class="token keyword">Index</span> Scan <span class="token keyword">on</span> i_docs__title_content_index_col  <span class="token punctuation">(</span>cost<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">.</span><span class="token number">.12</span><span class="token number">.63</span> <span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">50</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
               <span class="token keyword">Index</span> Cond: <span class="token punctuation">(</span>search_title_content_index_col @@ to_tsquery<span class="token punctuation">(</span><span class="token string">'postgres'</span>::<span class="token keyword">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">5</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>
<span class="token comment">-- 检索数据</span>
fence<span class="token operator">=</span><span class="token comment"># select count(1) from t_docs where search_title_content_index_col @@  to_tsquery('postgres');</span>
 count
<span class="token comment">-------</span>
  <span class="token number">4002</span>
</code></pre></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/12/08, 06:34:37</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/notes/pages/f14bdb/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">@AutoWired VS @Resource VS @Inject</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/notes/pages/f14bdb/">@AutoWired VS @Resource VS @Inject</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span></br><b>Powered by</b> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing">vuepress-theme-vdoing</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/notes/assets/js/app.c9716de5.js" defer></script><script src="/notes/assets/js/2.73d4029d.js" defer></script><script src="/notes/assets/js/15.bff124da.js" defer></script>
  </body>
</html>
